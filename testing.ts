import {MAVLinkMessage, MAVLinkModule} from "./src";

import {messageRegistry} from "./api/message-registry";

const mavLink = new MAVLinkModule(messageRegistry)
mavLink.upgradeLink()

let data_heartbeat: Buffer = Buffer.from('fd0900006f010100000000000000020351030366ad', 'hex');
let data_multi: Buffer = Buffer.from('fd1c00007001011e0000ade30700f5d292bd83b234bdda053f3db8aa6db9f89ba5b9508566bab5e2fd1100007101014a000000000000ce87e03cb8fe1144340cf3bc021c9afd2c0000720101a400000000000000000000e835fabd00000000000000000ae81cc100000000000000000000000093feebea16cfe858131ffd0c0000730101b200006f69cfba1063e8ba4a24f3bdef46', 'hex');
let data_multi_error: Buffer = Buffer.from('fd1500006a0101fd000006466c6967687420706c616e2072656365697665646dcbfd0200006b01012f0000ffbe4becfd1000006c01010100002ffc61132f9c61122f9c711300002b3162fffd0200006d01017d00008813ae62fd0700006e01019800000000ffff0000025172fd0c00006f01013e0000832610b802bbf43879ea64bab0a6fd0100007001012a000000e940fd0c000071010124000013236cf7e803e803e803e80305bcfd29000072010141000087ea5704dc05dc05e803dc050807e803e8030807000000000000000000000000000000000000000010d7e3fd1d00007301011b000013236cf7100000000000000017fc03000300030084002000f401009411856cfd18000074010174000087ea57040000000017fc03000300040084002000f4019411f736fd16000075010181000087ea570400000000000000000000000084002000f401e144fd0e00007601011d000087ea570467027d4400000000ac0df038fd0e000077010189000087ea570462017d4400000000ac0d9544fd2b000078010118000098cd69f7100000004cbace25982a3206742700007900c80000000000060a000000002c0100002c01000028ac45fd1c00007901011e000087ea570436e52e3d896347bd078b78bc0835a53900989039dca2243adb0cfd1200007a01014a00000000000066cbc93c999921411aa50eba6701d436fd0c00007b0101020000d3aa2d3e26bc050087ea570447b6fd1c00007c0101a300001ead6abb49146cbba1e151bb0000000000000000f6001a3b8755cd3aa936fd2c00007d0101a400000000000000000000d1b832be00000000000000000ae81cc10000000000000000feff1f344cbace25982a3206bf42fd0c00007e0101b20000761ee53afd6dcb3a415929befb9afd0200007f0101a500008813a85dfd1500008001018800004bbace259b2a3206000000000ad7a3bc64000000e01f40fd160000810101c100001d98093c6a1aa23bd287c538e9c0743c000000003f03505cfd140000820101f1000013236cf7100000006ea42d3b9cc1443bcdfe313bcf9cfd1e00008301019300000000000000000000ff7f2b31ffffffffffffffffffffffffffffffffffffd571', 'hex');
let data_multi_ack_error: Buffer = Buffer.from('fd1500003f0101fd000006466c6967687420706c616e20726563656976656486b0fd0200004001012f0000ffbebfb2fd190000410101160000000000410f05ffff4d49535f544f54414c000000000000000432ac', 'hex');

//console.log(data_multi_error.readUIntLE(7, 3));
//console.log(mavLink.parse(data_multi))

mavLink.on("message", data => {
    //console.log(data)
})

mavLink.on('message', function (message: MAVLinkMessage) {

    const excludedMessages: string[] = [

    ]

    // event listener for all messages
    if (!excludedMessages.includes(message._message_name)) {
        console.log('MESSAGE FROM MAV: ' + message._message_name + ': ', [message])
    }
})

mavLink.parse(data_multi_ack_error)